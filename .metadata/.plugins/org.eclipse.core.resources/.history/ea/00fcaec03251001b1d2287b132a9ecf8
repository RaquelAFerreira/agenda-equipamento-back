package br.com.alterdata.agendaDiaReservado.services;

import java.time.LocalDate;
import java.util.List;
import java.util.Optional;

import javax.transaction.Transactional;

import br.com.alterdata.agendaEquipamento.exceptions.DiaReservadoDuplicadoException;
import br.com.alterdata.agendaEquipamento.models.DiaReservado;
import br.com.alterdata.agendaEquipamento.repositorys.DiaReservadoRepository;

public class DiaReservadoService {

	DiaReservadoRepository diaReservadoRepository;
	
	@Transactional
	public DiaReservado create(DiaReservado diaReservado) throws DiaReservadoDuplicadoException{
		DiaReservado diaReservadoEncontrado = diaReservadoRepository.getWithCodigoDiaReservado(diaReservado.getCodigoDiaReservado());
		if (diaReservadoEncontrado == null) {
			return diaReservadoRepository.save(diaReservado);	
		} else {
			throw new DiaReservadoDuplicadoException(diaReservado.getCodigoDiaReservado());
		}
	}
	
	@Transactional
	public DiaReservado getByDaya(LocalDate data){
		return diaReservadoRepository.getWithData(data);
	}

	@Transactional
	public List<DiaReservado> getAll(){
		List<DiaReservado> diaReservados = diaReservadoRepository.findAll();
		return diaReservados;
	}
	
	@Transactional
	public Optional<DiaReservado> getbyId(Integer id){
		return diaReservadoRepository.findById(id);
	}
	
	@Transactional
	public boolean delete(Integer id){
		Optional<DiaReservado> diaReservado = diaReservadoRepository.findById(id);
		
		if (diaReservado.isPresent()) {
			diaReservadoRepository.delete(diaReservado.get());
			return true; 
		} else {
			return false;
		}
	}
	
	@Transactional
	public DiaReservado update(Integer id, DiaReservado diaReservado){
		Optional<DiaReservado> diaReservadoSelecionado = diaReservadoRepository.findById(id);
		DiaReservado diaReservadoAtualizado = diaReservadoSelecionado.get();
		
		if (diaReservado.getDescricao().equals("") == false && diaReservado.getDescricao() != null) {
			diaReservadoAtualizado.setDescricao(diaReservado.getDescricao());
		}
		
//		if (diaReservado.isDisponivel() == true || diaReservado.isDisponivel() == false ) {
//			diaReservadoAtualizado.setDisponivel(diaReservado.isDisponivel());
//		}
		
		return diaReservadoRepository.save(diaReservadoAtualizado);
	}
}
